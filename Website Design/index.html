<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DMS Inc. – Culvert Rating</title>
    <!-- this is linking the shared stylesheet that contains light/dark tokens -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- this is the site header with brand, nav, and the theme toggle button -->
    <header class="site-header">
      <div class="brand">
        <img src="DMSLOGO.PNG" alt="DMS Inc. Logo" class="brand-logo" />
      </div>

      <nav class="nav">
        <a href="index.html" class="active">Home</a>
        <a href="info.html">Info</a>
        <a href="rate.html">Rate a Culvert</a>
      </nav>

      <!-- this is the theme toggle control; JS looks for id="theme-toggle" -->
      <button
        id="theme-toggle"
        class="theme-toggle"
        aria-pressed="false"
        title="Toggle theme"
      >
        <span class="theme-toggle__icon" aria-hidden="true"></span>
        <span class="theme-toggle__label">Theme</span>
      </button>
    </header>

    <main>
      <!-- this is the hero section with image + gradient overlay text -->
      <section class="hero">
        <img
          src="./Town-of-Seymour-Tower-Drive_2117-PRINT.jpg"
          alt="Culvert at Tower Drive, Town of Seymour"
          class="hero-img"
          width="800"
          height="475"
        />
        <div class="hero-overlay">
          <h1>Probabilistic Culvert Condition Rating</h1>
          <p>Possibly more text here explaining something</p>
        </div>
      </section>

      <!-- this is the card grid that links to pages -->
      <section class="cards">
        <a class="card card-link" href="info.html" aria-label="Project Info">
          <h2>Project Info</h2>
          <p>Overview, team, and documentation.</p>
        </a>

        <a class="card card-link" href="rate.html" aria-label="Rate a Culvert">
          <h2>Rate a Culvert</h2>
          <p>
            Enter culvert details to get a 1–5 rating (backend coming soon).
          </p>
        </a>
      </section>

      <!-- this is a short explanatory blurb -->
      <section class="blurb">
        <h3>What this site does</h3>
        <p>
          Enter nine parameters—soil, environment, and culvert attributes—and
          the system returns a predicted condition rating with explanations
          (probabilities and factor importance) once the backend is connected.
          No logins, no personal data, and designed to be fast and easy to use.
        </p>
      </section>
    </main>

    <!-- this is the footer -->
    <footer class="site-footer">
      <small>
        © 2025 DMS Inc. · Capstone CSC4910 · Client: Dr. Sadegh Asgari · Team
        Charter & roles summarized here.
      </small>
    </footer>

    <!-- this is the inline theme controller (works without theme.js) -->
    <script>
      // this is the theme controller: reads system/user preference, toggles data-theme, and updates the button
      (function () {
        // this is the localStorage key we use to remember the user's choice
        const STORAGE_KEY = "theme-preference";

        // this is the root element and the toggle button
        const root = document.documentElement;
        const toggle = document.getElementById("theme-toggle");

        // this is a guard: if there is no toggle on this page, do nothing
        if (!toggle) return;

        // this is the starting theme: prefer stored value; otherwise follow system
        const stored = localStorage.getItem(STORAGE_KEY);
        const prefersDark =
          window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: dark)").matches;
        const initial = stored ?? (prefersDark ? "dark" : "light");
        setTheme(initial);

        // this is the click handler that flips between light/dark
        toggle.addEventListener("click", () => {
          const next =
            root.getAttribute("data-theme") === "dark" ? "light" : "dark";
          setTheme(next, true);
        });

        // this is a listener to follow system changes if user hasn't explicitly chosen
        const mq = window.matchMedia("(prefers-color-scheme: dark)");
        mq.addEventListener?.("change", (e) => {
          if (!localStorage.getItem(STORAGE_KEY)) {
            setTheme(e.matches ? "dark" : "light");
          }
        });

        // this is the function that applies theme and updates UI + persistence
        function setTheme(mode, persist = false) {
          root.setAttribute("data-theme", mode);
          if (persist) localStorage.setItem(STORAGE_KEY, mode);

          const isDark = mode === "dark";
          toggle.setAttribute("aria-pressed", String(isDark));
          const icon = toggle.querySelector(".theme-toggle__icon");
          if (icon) icon.textContent = isDark ? "" : "";
        }
      })();
    </script>
  </body>
</html>
